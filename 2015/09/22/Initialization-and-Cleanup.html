<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Initialization &amp; Cleanup - Jing Chen</title>

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta name="description" content="">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Initialization &amp; Cleanup">
    <meta name="twitter:description" content="">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Initialization &amp; Cleanup">
    <meta property="og:description" content="">

    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
    <link href="/apple-touch-icon-precomposed.png" rel="apple-touch-icon">

    <link rel="stylesheet" type="text/css" href="//milantracy.github.io/themes/uno/assets/css/uno.css?v=1.0.0" />

    <link rel="canonical" href="https://milantracy.github.io/2015/09/22/Initialization-and-Cleanup.html" />
    
    <meta property="og:site_name" content="Jing Chen" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Initialization &amp; Cleanup" />
    <meta property="og:description" content="As the computer revolution progresses, “unsafe” programming has become one of the major culprits that makes programming expensive. Two of these safety issues are initialization and cleanup. Cleanup is a special problem because it’s easy to forget about an..." />
    <meta property="og:url" content="https://milantracy.github.io/2015/09/22/Initialization-and-Cleanup.html" />
    <meta property="article:published_time" content="2015-09-22T07:00:00.000Z" />
    <meta property="article:modified_time" content="2015-11-15T09:11:28.049Z" />
    <meta property="article:tag" content="Java" />
    <meta property="article:tag" content="Thinking in Java" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Initialization &amp; Cleanup" />
    <meta name="twitter:description" content="As the computer revolution progresses, “unsafe” programming has become one of the major culprits that makes programming expensive. Two of these safety issues are initialization and cleanup. Cleanup is a special problem because it’s easy to forget about an..." />
    <meta name="twitter:url" content="https://milantracy.github.io/2015/09/22/Initialization-and-Cleanup.html" />
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Jing Chen",
    "author": {
        "@type": "Person",
        "name": "Jing Chen",
        "image": "https://avatars.githubusercontent.com/u/6878258?v=3",
        "url": "undefined/author/undefined",
        "sameAs": null
    },
    "headline": "Initialization &amp; Cleanup",
    "url": "https://milantracy.github.io/2015/09/22/Initialization-and-Cleanup.html",
    "datePublished": "2015-09-22T07:00:00.000Z",
    "dateModified": "2015-11-15T09:11:28.049Z",
    "keywords": "Java,  Thinking in Java",
    "description": "As the computer revolution progresses, “unsafe” programming has become one of the major culprits that makes programming expensive. Two of these safety issues are initialization and cleanup. Cleanup is a special problem because it’s easy to forget about an..."
}
    </script>

    <meta name="generator" content="Ghost ?" />
    <link rel="alternate" type="application/rss+xml" title="Jing Chen" href="https://milantracy.github.io/rss" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/default.min.css">

</head>
<body class="post-template tag-Java tag-Thinking-in-Java no-js">

    <span class="mobile btn-mobile-menu">
        <i class="icon icon-list btn-mobile-menu__icon"></i>
        <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
    </span>

    <header class="panel-cover panel-cover--collapsed " style="background-image: url(http://s1.thcdn.com/design-assets/products/10780752/b.jpg)">
      <div class="panel-main">
    
        <div class="panel-main__inner panel-inverted">
        <div class="panel-main__content">
    
            <h1 class="panel-cover__title panel-title"><a href="https://milantracy.github.io" title="link to homepage for Jing Chen">Jing Chen</a></h1>
            <hr class="panel-cover__divider" />
            <p class="panel-cover__description">Software Developer</p>
            <hr class="panel-cover__divider panel-cover__divider--secondary" />
    
            <div class="navigation-wrapper">
    
              <nav class="cover-navigation cover-navigation--primary">
                <ul class="navigation">
                  <li class="navigation__item"><a href="https://milantracy.github.io/#blog" title="link to Jing Chen blog" class="blog-button">Blog</a></li>
                </ul>
              </nav>
    
              
              
              <nav class="cover-navigation navigation--social">
                <ul class="navigation">
              
                  <!-- Twitter -->
                  <li class="navigation__item">
                    <a href="https://www.facebook.com/profile.php?id=100006454394797" title="Facebook account">
                      <i class='icon icon-social-facebook'></i>
                      <span class="label">Facebook</span>
                    </a>
                  </li>
              
                  <!-- Twitter -->
                  <li class="navigation__item">
                    <a href="https://twitter.com/ChenCristiano?lang=en" title="Twitter account">
                      <i class='icon icon-social-twitter'></i>
                      <span class="label">Twitter</span>
                    </a>
                  </li>
              
              
                  <!-- Github -->
                  <li class="navigation__item">
                    <a href="https://github.com/milantracy" title="Github account">
                      <i class='icon icon-social-github'></i>
                      <span class="label">Github</span>
                    </a>
                  </li>
                  </li>
              
              
              
              
                  <!-- LinkedIn -->
                  <li class="navigation__item">
                    <a href="https://www.linkedin.com/pub/jing-chen/71/b60/363" title="LinkedIn account">
                      <i class='icon icon-social-linkedin'></i>
                      <span class="label">LinkedIn</span>
                    </a>
                  </li>
              
                  <!-- Email -->
                  <li class="navigation__item">
                    <a href="mailto:milantracy@gmail.com" title="Email milantracy@gmail.com">
                      <i class='icon icon-mail'></i>
                      <span class="label">Email</span>
                    </a>
                  </li>
              
                </ul>
              </nav>
              
    
            </div>
    
          </div>
    
        </div>
    
        <div class="panel-cover--overlay"></div>
      </div>
    </header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            

  <article class="post-container post-container--single">

    <header class="post-header">
      <div class="post-meta">
        <time datetime="22 Sep 2015" class="post-meta__date date">22 Sep 2015</time> &#8226; <span class="post-meta__tags tags">on <a href="https://milantracy.github.io/tag/Java">Java</a>, <a href="https://milantracy.github.io/tag/Thinking-in-Java"> Thinking in Java</a></span>
        <span class="post-meta__author author"><img src="https://avatars.githubusercontent.com/u/6878258?v=3" alt="profile image for Jing Chen" class="avatar post-meta__avatar" /> by Jing Chen</span>
      </div>
      <h1 class="post-title">Initialization &amp; Cleanup</h1>
    </header>

    <section class="post tag-Java tag-Thinking-in-Java">
      <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>As the computer revolution progresses, “<strong>unsafe</strong>” programming has become one of the major culprits that makes programming expensive.</p>
</div>
<div class="paragraph">
<p>Two of these safety issues are <em>initialization</em> and <em>cleanup</em>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Cleanup is a special problem because it’s easy to forget about an element when you’re done with it, since it no longer concerns you. Thus, the resources used by that element are retained and you can easily end up running out of resources (most notably, memory).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_guaranteed_initialization_with_the_constructor">Guaranteed initialization with the constructor</h5>
<div class="paragraph">
<p>In Java, the class designer can guarantee initialization of every object by providing a constructor. If a class has a constructor, Java automatically calls that constructor when an object is created, before users can even get their hands on it. So initialization is guaranteed.</p>
</div>
<div class="paragraph">
<p>The <strong><em>name of the constructor</em></strong> is the <strong>same</strong> as the <em>name of the class</em>. It makes sense that such a method will be called automatically during initialization.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Note that the coding style of making the first letter of all methods lowercase does not apply to constructors, since the name of the constructor must match the name of the class exactly.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The constructor is an unusual type of method because it has <strong><em>no return value</em></strong>. This is distinctly different from a void return value, in which the method returns nothing</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">class Rock {
      Rock() { // This is the constructor
        System.out.print("Rock ");
      }
}

public class SimpleConstructor{
     public static void main(String[] args) {
    	for(int i = 0; i &lt; 10; i++)
        	new Rock();
     }
} /*</code></pre>
</div>
</div>
<div class="paragraph">
<p>Output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Rock Rock Rock Rock Rock Rock Rock Rock Rock Rock</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_method_overloading">Method overloading</h5>
<div class="paragraph">
<p><em>Method overloading</em> is essential to allow the <strong>same method name</strong> to be used with different <strong>method signiture</strong>.</p>
</div>
<div class="paragraph">
<p>Each overloaded method must take a <strong>unique list</strong> of argument types. Even differences in the ordering of arguments are sufficient to distinguish two methods, although you don’t normally want to take this approach because it produces difficult-to-maintain code</p>
</div>
<div class="paragraph">
<p>The JVM doesn’t consider <strong>return type</strong> when differentiating two method, the <strong>method signature</strong> is the only issue.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Overloading with primitives</p>
<div class="ulist">
<ul>
<li>
<p>A primitive can be automatically promoted from a smaller type to a larger one, and this can be slightly confusing in combination with overloading.</p>
</li>
<li>
<p>If an overloaded method is available that takes an int, it is used.</p>
</li>
<li>
<p>In all other cases, if you have a data type that is smaller than the argument in the method, that data type is promoted.</p>
</li>
<li>
<p>If it doesn’t find an exact char match, it is promoted to int.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_default_constructors">Default constructors</h5>
<div class="paragraph">
<p>A default constructor (a.k.a. a “no-arg” constructor) is one without arguments that is used to create a “default object.” If you create a class that has no constructors, the compiler will <strong>automatically</strong> create a default constructor for you.</p>
</div>
</div>
<div class="sect4">
<h5 id="_the_em_this_em_keyword">The <em>this</em> keyword</h5>
<div class="paragraph">
<p>The <strong>this</strong> keyword, which can be used only inside a non-static method—produces the reference to the object that the method has been called for.</p>
</div>
<div class="paragraph">
<p>The this keyword is used only for those special cases in which you need to <strong>explicitly</strong> use the reference to the <strong>current object</strong>. For example, it’s often used in return statements when you want to return the reference to the current object.</p>
</div>
<div class="paragraph">
<p>The <strong>this</strong> keyword is also useful for passing the current object to another method.</p>
</div>
</div>
<div class="sect4">
<h5 id="_calling_constructors_from_constructors">Calling constructors from constructors</h5>
<div class="paragraph">
<p>When you write several constructors for a class, there are times when you’d like to call one constructor from another to avoid duplicating code. You can make such a call by using the <strong>this</strong> keyword.</p>
</div>
</div>
<div class="sect4">
<h5 id="_hiding_data_field">Hiding data field</h5>
<div class="paragraph">
<p>In the constructor, if the argument of the constructor hide the data field, you may use this to explicitly refer to the data field of the current object.</p>
</div>
</div>
<div class="sect4">
<h5 id="_the_meaning_of_em_static_em">The meaning of <em>static</em></h5>
<div class="paragraph">
<p>You cannot call non-static methods from inside static methods2 (although the reverse is possible), and you can call a static method for the class itself, without any object.</p>
</div>
<div class="paragraph">
<p>It’s as if you’re creating the equivalent of a <strong>global method</strong>. However, global methods are not permitted in Java, and putting the <strong>static</strong> method inside a class allows it access to other <strong>static</strong> methods and to <strong>static</strong> fields.</p>
</div>
<div class="paragraph">
<p>All objects of the class would share only <strong>one single copy</strong> of the class&#8217;s static field and static method.</p>
</div>
<hr>
</div>
<div class="sect2">
<h3 id="_cleanup_finalization_and_garbage_collection">Cleanup: finalization and garbage collection</h3>
<div class="paragraph">
<p>Of course, Java has the garbage collector to reclaim the memory of objects that are no longer used.</p>
</div>
<div class="paragraph">
<p>Now consider an unusual case: Suppose your object allocates “special” memory without using new. The garbage collector only knows how to release memory allocated with new, so it won’t know how to release the object’s “special” memory. To handle this case, Java provides a method called <strong><em>finalize</em></strong>( ) that you can define for your class.</p>
</div>
<div class="paragraph">
<p>When the garbage collector is ready to release the storage used for your object, it will first call <strong><em>finalize</em></strong>( ), and only on the next garbage-collection pass will it reclaim the object’s memory.</p>
</div>
<div class="sect4">
<h5 id="_garbage_colletion_is_different_from_destructor_in_c">Garbage colletion is different from destructor in C++.</h5>
<div class="paragraph">
<p>In C++, objects always get destroyed (in a bug-free program), whereas in Java, objects do not always get garbage collected.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Your objects might not get garbage collected.</strong></p>
</li>
<li>
<p><strong>Garbage collection is not destruction.</strong></p>
<div class="ulist">
<ul>
<li>
<p>If there is some activity that must be performed before you no longer need an object, you must perform that activity yourself.</p>
</li>
<li>
<p>for example, if you draw something on screer, if you do nothing, it never gets clean up, if you put some erasing function inside <strong><em>finalize()</em></strong>, it may be cleaned up when the program needs a garbage collection.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Garbage collection would happen when it nears the point of running out of the memory, if it nevers reach that point, <strong>the resource would be returned to the OS as long as the program exits</strong>. It is a good thing because garbage collection requires <strong>overhead</strong>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_garbage_colletion_is_only_about_memory">Garbage colletion is only about memory</h5>
<div class="paragraph">
<p>The garbage collector takes care of the release of all object memory regardless of how the object is created.</p>
</div>
<div class="paragraph">
<p>It would seem that finalize( ) is in place because of the possibility that you’ll do something Clike by allocating memory using a mechanism other than the normal one in Java. This can happen primarily through native methods, which are a way to call non-Java code from Java.</p>
</div>
<div class="paragraph">
<p>If you want some kind of <strong>cleanup performed other than storage release</strong>, you must still explicitly call an appropriate method in Java, which is the equivalent of a C++ destructor without the convenience.</p>
</div>
<div class="paragraph">
<p><strong>You won’t use finalize( ) much</strong></p>
</div>
<div class="paragraph">
<p>If you want some kind of cleanup performed other than storage release, you must still <strong>explicitly</strong> call an appropriate method in Java, which is the equivalent of a C++ destructor without the convenience.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Remember that neither garbage collection nor finalization is guaranteed. If the JVM isn’t close to running out of memory, then it might not waste time recovering memory through garbage collection.</code></pre>
</div>
</div>
<hr>
</div>
</div>
<div class="sect2">
<h3 id="_how_a_garbage_collector_works">How a garbage collector works</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Reference Counting</strong></p>
<div class="ulist">
<ul>
<li>
<p>Each object contains a reference count, every time a reference is attached to the object, increase the reference count, every time the reference goes out of scope or set to be null, decrese the refernece count.</p>
</li>
<li>
<p>Small and constant overhead, but it happens throughout the lifetime of the program.</p>
</li>
<li>
<p>Can&#8217;t deal with circularly referenced objects.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Stop and copy</strong></p>
<div class="ulist">
<ul>
<li>
<p>This means that—for reasons that will become apparent—the program is first stopped Then, each live object is copied from one heap to another, leaving behind all the garbage. In addition, as the objects are copied into the new heap, they are packed end-to-end, thus compacting the new heap</p>
</li>
<li>
<p>requires two heaps</p>
</li>
<li>
<p>when there is no need to do garbege collection, stop and copy would still waste time and resource switching back and forth</p>
</li>
</ul>
</div>
</li>
<li>
<p>Swap and age</p>
</li>
</ol>
</div>
<hr>
</div>
<div class="sect2">
<h3 id="_jit">JIT</h3>
<div class="paragraph">
<p>A JIT compiler partially or fully converts a program into <strong>native machine code</strong> so that it doesn’t need to be interpreted by the JVM and thus runs much faster.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>JIT takes a little more time</p>
</li>
<li>
<p>JIT increases the size of the executable which might cause page, which makes programs slow down.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>An alternative approach is <strong><em>lazy evaluation</em></strong>, which means that the code is not JIT compiled until necessary.</p>
</div>
<hr>
</div>
<div class="sect2">
<h3 id="_member_initialization">Member initialization</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>local variables are guaranted to be initialized by throwing error when compiled for uninitialization</p>
</li>
<li>
<p>data fields are guaranteed to have an initial value.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_order_of_initialization">Order of initialization</h5>
<div class="ulist">
<ul>
<li>
<p>Within a class, the order of initialization is determined by <strong>the order that the variables are defined within the class</strong>.</p>
</li>
<li>
<p>The variables are initialized <strong>before any methods</strong> can be called—even the constructor.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_static_data_initialization">static data initialization</h5>
<div class="paragraph">
<p>There’s only a single piece of storage for a static, regardless of how many objects are created.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>static</strong> initialization occurs only if it’s necessary.</p>
</li>
<li>
<p>when the first <strong>static</strong> access occurs, static objects would be initialized</p>
</li>
<li>
<p>The order of initialization is <strong>statics</strong> first, if they haven’t already been initialized by a previous object creation, and then the <strong>non-static</strong> objects</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_initialization_summary">initialization summary</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>As a class is loaded(creating a Class object,all of its <strong>static</strong> initializers are run. Thus, static initialization takes place only once, as the Class object is loaded for the first time.</p>
</li>
<li>
<p>When it calls a static method or access a static field, the class would also be loaded which initializes static field first.</p>
</li>
<li>
<p>Any initializations that occur at the point of field definition are executed.</p>
</li>
<li>
<p>Constructors are executed.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_explicit_em_static_em_initialization">explicit <em>static</em> initialization</h5>
<div class="paragraph">
<p>Java allows you to group other static initializations inside a special “static clause”(sometimes called a static block) in a class. It looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">//: initialization/Spoon.java
    public class Spoon {
      static int i;
      static {
i = 47; }
} ///:~</code></pre>
</div>
</div>
<div class="paragraph">
<p>It’s just the static keyword followed by a block of code. This code, like other static initializations, is executed <strong>only once</strong>: the first time you make an object of that class or the first time you access a static member of that class.</p>
</div>
<div class="paragraph">
<p>There is also non-static block to initialize non-static field, that is helpful in inner class.</p>
</div>
</div>
</div>
    </section>

  </article>




            <footer class="footer">
                <span class="footer__copyright">&copy; 2015. All rights reserved.</span>
                <span class="footer__copyright"><a href="http://uno.daleanthony.com" title="link to page for Uno Ghost theme">Uno theme</a> by <a href="http://daleanthony.com" title="link to website for Dale-Anthony">Dale-Anthony</a></span>
                <span class="footer__copyright">Proudly published with <a href="http://hubpress.io" title="link to Hubpress website">Hubpress</a></span>
            </footer>
        </div>
    </div>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js?v="></script> 
      <script type="text/javascript">
        jQuery( document ).ready(function() {
          // change date with ago
          jQuery('ago.ago').each(function(){
            var element = jQuery(this).parent();
            element.html( moment(element.text()).fromNow());
          });
        });

        hljs.initHighlightingOnLoad();      
      </script>

    <script type="text/javascript" src="//milantracy.github.io/themes/uno/assets/js/main.js?v=1.0.0"></script>
    
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-67853404-1', 'auto');
    ga('send', 'pageview');

    </script>

</body>
</html>
