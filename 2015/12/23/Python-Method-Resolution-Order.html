<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Python Method Resolution Order - Jing Chen</title>

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta name="description" content="">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Python Method Resolution Order">
    <meta name="twitter:description" content="">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Python Method Resolution Order">
    <meta property="og:description" content="">

    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
    <link href="/apple-touch-icon-precomposed.png" rel="apple-touch-icon">

    <link rel="stylesheet" type="text/css" href="//milantracy.github.io/themes/uno/assets/css/uno.css?v=1.0.0" />

    <link rel="canonical" href="https://milantracy.github.io/2015/12/23/Python-Method-Resolution-Order.html" />
    
    <meta property="og:site_name" content="Jing Chen" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Python Method Resolution Order" />
    <meta property="og:description" content="In languages that use multiple inheritance, the order in which base classes are searched when looking for a method is often called the Method Resolution Order or MRO, in Python, it also applies to other attributes. Python has known at..." />
    <meta property="og:url" content="https://milantracy.github.io/2015/12/23/Python-Method-Resolution-Order.html" />
    <meta property="article:published_time" content="2015-12-23T08:00:00.000Z" />
    <meta property="article:modified_time" content="2016-01-12T03:10:52.106Z" />
    <meta property="article:tag" content="Python" />
    <meta property="article:tag" content="Inherirance" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Python Method Resolution Order" />
    <meta name="twitter:description" content="In languages that use multiple inheritance, the order in which base classes are searched when looking for a method is often called the Method Resolution Order or MRO, in Python, it also applies to other attributes. Python has known at..." />
    <meta name="twitter:url" content="https://milantracy.github.io/2015/12/23/Python-Method-Resolution-Order.html" />
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Jing Chen",
    "author": {
        "@type": "Person",
        "name": "Jing Chen",
        "image": "https://avatars.githubusercontent.com/u/6878258?v=3",
        "url": "undefined/author/undefined",
        "sameAs": null
    },
    "headline": "Python Method Resolution Order",
    "url": "https://milantracy.github.io/2015/12/23/Python-Method-Resolution-Order.html",
    "datePublished": "2015-12-23T08:00:00.000Z",
    "dateModified": "2016-01-12T03:10:52.106Z",
    "keywords": "Python,  Inherirance",
    "description": "In languages that use multiple inheritance, the order in which base classes are searched when looking for a method is often called the Method Resolution Order or MRO, in Python, it also applies to other attributes. Python has known at..."
}
    </script>

    <meta name="generator" content="Ghost ?" />
    <link rel="alternate" type="application/rss+xml" title="Jing Chen" href="https://milantracy.github.io/rss" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/default.min.css">

</head>
<body class="post-template tag-Python tag-Inherirance no-js">

    <span class="mobile btn-mobile-menu">
        <i class="icon icon-list btn-mobile-menu__icon"></i>
        <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
    </span>

    <header class="panel-cover panel-cover--collapsed " style="background-image: url(http://s1.thcdn.com/design-assets/products/10780752/b.jpg)">
      <div class="panel-main">
    
        <div class="panel-main__inner panel-inverted">
        <div class="panel-main__content">
    
            <h1 class="panel-cover__title panel-title"><a href="https://milantracy.github.io" title="link to homepage for Jing Chen">Jing Chen</a></h1>
            <hr class="panel-cover__divider" />
            <p class="panel-cover__description">Software Developer</p>
            <hr class="panel-cover__divider panel-cover__divider--secondary" />
    
            <div class="navigation-wrapper">
    
              <nav class="cover-navigation cover-navigation--primary">
                <ul class="navigation">
                  <li class="navigation__item"><a href="https://milantracy.github.io/#blog" title="link to Jing Chen blog" class="blog-button">Blog</a></li>
                </ul>
              </nav>
    
              
              
              <nav class="cover-navigation navigation--social">
                <ul class="navigation">
              
                  <!-- Twitter -->
                  <li class="navigation__item">
                    <a href="https://www.facebook.com/profile.php?id=100006454394797" title="Facebook account">
                      <i class='icon icon-social-facebook'></i>
                      <span class="label">Facebook</span>
                    </a>
                  </li>
              
                  <!-- Twitter -->
                  <li class="navigation__item">
                    <a href="https://twitter.com/ChenCristiano?lang=en" title="Twitter account">
                      <i class='icon icon-social-twitter'></i>
                      <span class="label">Twitter</span>
                    </a>
                  </li>
              
              
                  <!-- Github -->
                  <li class="navigation__item">
                    <a href="https://github.com/milantracy" title="Github account">
                      <i class='icon icon-social-github'></i>
                      <span class="label">Github</span>
                    </a>
                  </li>
                  </li>
              
              
              
              
                  <!-- LinkedIn -->
                  <li class="navigation__item">
                    <a href="https://www.linkedin.com/pub/jing-chen/71/b60/363" title="LinkedIn account">
                      <i class='icon icon-social-linkedin'></i>
                      <span class="label">LinkedIn</span>
                    </a>
                  </li>
              
                  <!-- Email -->
                  <li class="navigation__item">
                    <a href="mailto:milantracy@gmail.com" title="Email milantracy@gmail.com">
                      <i class='icon icon-mail'></i>
                      <span class="label">Email</span>
                    </a>
                  </li>
              
                </ul>
              </nav>
              
    
            </div>
    
          </div>
    
        </div>
    
        <div class="panel-cover--overlay"></div>
      </div>
    </header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            

  <article class="post-container post-container--single">

    <header class="post-header">
      <div class="post-meta">
        <time datetime="23 Dec 2015" class="post-meta__date date">23 Dec 2015</time> &#8226; <span class="post-meta__tags tags">on <a href="https://milantracy.github.io/tag/Python">Python</a>, <a href="https://milantracy.github.io/tag/Inherirance"> Inherirance</a></span>
        <span class="post-meta__author author"><img src="https://avatars.githubusercontent.com/u/6878258?v=3" alt="profile image for Jing Chen" class="avatar post-meta__avatar" /> by Jing Chen</span>
      </div>
      <h1 class="post-title">Python Method Resolution Order</h1>
    </header>

    <section class="post tag-Python tag-Inherirance">
      <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In languages that use multiple inheritance, the order in which base classes are searched when looking for a method is often called the <strong>Method Resolution Order</strong> or <strong>MRO</strong>, in Python, it also applies to other attributes.</p>
</div>
<div class="paragraph">
<p>Python has known at least three different MRO algorithms, classic, Python 2.2 style, C3 and Python3.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_classic">Classic</h3>
<div class="paragraph">
<p>Classic classes used a simple MRO scheme: when Python looks for a method or a attribute, base classes wewe searched using a simple <strong>depth-first</strong> and <strong>left-to-right</strong>(defined in the subclass) scheme. The first matching obejct found during this search would be returned.</p>
</div>
<div class="paragraph">
<p>For example, we have following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">class A:
  def test(self): pass


class B(A):
  pass

class C:
  def test(self):
    pass

class D(B, C): pass</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we create an instance of class D, the classic method resolution order would be D, B, A, C. Thus, a search for the method <em>test</em> () would produce A.test(). In this example, when python find method <em>test</em> () in the class A, it will be retuened and run immeadiately, class C won&#8217;t be searched.</p>
</div>
</div>
<div class="sect2">
<h3 id="_new_style">New Style</h3>
<div class="paragraph">
<p>All new style classes would be defined by inheriting from a base class <strong>object</strong>.</p>
</div>
<div class="paragraph">
<p>Thus, any use of <strong>multiple inheritance</strong> in new style classes would always create the diamond realtionship. Since object defined a number of methods that are sometimes extended by subtypes, the resolution order is critical.</p>
</div>
<div class="paragraph">
<p>In Python 2.2, a MRO scheme is that the MRO would be <strong>pre-computed</strong> when a class was defined and <strong>stored as an attribute</strong> of eah class object.</p>
</div>
<div class="paragraph">
<p>In Python 2.2, the basic MRO would be <strong>depth first, left to right</strong> traversal of the classes as before, if any clas was duplicated in the search, all but the last occurence would be deleted from the MRO list. For exampe,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">class A(object):
  def test(): pass

class B(A):
  pass

class C(A):
  def test(): pass


class D(B, C):
  pass</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above code, the MRO was supposed to be D, B, A, C, A, however, with new style MRO, all duplcates would be removed except the last one, the actual resolution order is D, B, C, A.</p>
</div>
<div class="paragraph">
<p>In reality, the computation of the MRO was more complex than the previous two examples.</p>
</div>
<div class="paragraph">
<p>For more complex situation, the MRO algorithm tried to preserve the order of classes fro bases that appeard first in the search process. For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">class A(object): pass
class B(object): pass
class C(A, B): pass
class D(B, A): pass
class E(C, D): pass</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above code, with MRO in python 2.2, the order is E, C, D, B, A after removing dupcates from ECABDBA.</p>
</div>
<div class="paragraph">
<p>The algorithm tried to preserve the order of classes for bases that appeared first in the search process because it was first in the inheritance list. In this example, sicne A is first in the inheritance list, the MRO algorithm would try to preserve that orderin. Thus, the final ordering of the MRO algorithm goes to E, C, D, A, B.</p>
</div>
<div class="paragraph">
<p>Specifically, if a class A inherits from class B, then the MRO should obviously check A before B. Likewise, if a class B uses multiple inheritance to inherit from C and D. then B should be checked before C and ould be checked before D.</p>
</div>
<div class="sect3">
<h4 id="_c3">C3</h4>
<div class="paragraph">
<p>C3 MRO is all about <em>new style</em> classes, it folliws the old method resolution ordre, depth first and left to right. Therefore, there is no breaking of old code for classic classes.</p>
</div>
<div class="paragraph">
<p>With a complex inheritance hierarchy, you want to be able to satisfy all of these possible rules in a way that is monotonic, that is, if you have already determinied that class A should be checked before class B, then you should never encounter a situation that requires class B to be checked before class A, otherwise, the resule is undefined and the inheritance hierachy should be rejected.</p>
</div>
<div class="paragraph">
<p>Basically, the idea behind C3 is that if you write down all of the ordering rules imposed by inheritance relationships in a complex class hierarchy, the algorithm will determine a monotonic ordering of the classes that satisfies all of them.</p>
</div>
<div class="paragraph">
<p>MRO algorithm in Pythonn 2.2 was abandon in 2.3, one outcome of this is that python will now reject any inheritance hierarchy that has an inconsistent ordering of base classes.</p>
</div>
<div class="paragraph">
<p>In the last example, there is an ordering conflict between class C and class D. For class C, there is a rule that says class A should be checked before class B, however, for class D, the rule says that class B should be checked before class A.</p>
</div>
<div class="paragraph">
<p>In isolation, this discrepancy is fine, but if C and D are ever combined together in the same inheritance hierarchy for another class, that class will be rejected by C3 MRO algorithm.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_reference">Reference</h3>
<div class="paragraph">
<p>The History of Python: Method Rosulution Order</p>
</div>
</div>
    </section>

  </article>




            <footer class="footer">
                <span class="footer__copyright">&copy; 2016. All rights reserved.</span>
                <span class="footer__copyright"><a href="http://uno.daleanthony.com" title="link to page for Uno Ghost theme">Uno theme</a> by <a href="http://daleanthony.com" title="link to website for Dale-Anthony">Dale-Anthony</a></span>
                <span class="footer__copyright">Proudly published with <a href="http://hubpress.io" title="link to Hubpress website">Hubpress</a></span>
            </footer>
        </div>
    </div>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js?v="></script> 
      <script type="text/javascript">
        jQuery( document ).ready(function() {
          // change date with ago
          jQuery('ago.ago').each(function(){
            var element = jQuery(this).parent();
            element.html( moment(element.text()).fromNow());
          });
        });

        hljs.initHighlightingOnLoad();      
      </script>

    <script type="text/javascript" src="//milantracy.github.io/themes/uno/assets/js/main.js?v=1.0.0"></script>
    
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-67853404-1', 'auto');
    ga('send', 'pageview');

    </script>

</body>
</html>
